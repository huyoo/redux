{"version":3,"sources":["attachment/index.jsx"],"names":["__awaiter","thisArg","_arguments","P","generator","adopt","value","resolve","Promise","reject","fulfilled","step","next","e","rejected","result","done","then","apply","__rest","s","t","p","Object","prototype","hasOwnProperty","call","indexOf","getOwnPropertySymbols","i","length","propertyIsEnumerable","React","Button","Upload","get","message","cls","Icon","Tooltip","request","FileListComponent","DownloadModal","blobToFile","ToolBar","defaultLocale","isPhoto","SeidLocaleReceiver","thenProcess","option","res","file","onSuccess","onError","data","error","Attachment","arguments","promiseList","processedFileNumber","processArgs","state","downloadVisible","viewType","beforeUpload","fileList","props","uploadFileListLength","handleUpload","push","startUpload","maxUploadNum","fileType","entityId","fileSize","size","Math","round","name","FormData","append","processRequest","all","responses","forEach","response","rcOption","uploadUrl","onProgress","url","method","onUploadProgress","loaded","total","percent","Number","toFixed","headers","neverCancel","onChange","info","getThumbUrl","status","item","index","uid","splice","thumbUrl","filterList","filter","list","setState","handlerViewType","onChangeDownloadVisible","deleteFile","upload","handleRemove","downloadFile","Array","isArray","config","console","renderComponent","locale","_a","downloadable","className","style","showUploadList","onPreview","onShare","showByFileType","typeList","getFileType","rest","uploadProps","ref","options","select","fontSize","Component","defaultProps","code","getDerivedStateFromProps","nextProps","prevState","defaultFileList"],"mappings":"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","sourcesContent":["var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nimport React from 'react';\nimport Button from 'antd/es/button';\nimport Upload from 'antd/es/upload';\nimport get from 'lodash/get';\nimport message from 'antd/es/message';\nimport cls from 'classnames';\nimport Icon from 'antd/es/icon';\nimport Tooltip from 'antd/es/tooltip';\nimport { request } from '../utils';\nimport FileListComponent from './FileListComponent';\nimport DownloadModal, { blobToFile } from './DownloadModal';\nimport ToolBar from '../tool-bar';\nimport defaultLocale from './locale';\nimport { isPhoto } from '../_util/utils';\nimport SeidLocaleReceiver from '../seid-locale-receiver';\n// 文件上传接口回调\nconst thenProcess = (option, res) => {\n    const { file, onSuccess, onError } = option;\n    if (get(res, 'success')) {\n        onSuccess(res.data, file);\n    }\n    else {\n        message.error(get(res, 'message'));\n        onError(get(res, 'message'));\n    }\n};\nclass Attachment extends React.Component {\n    constructor() {\n        super(...arguments);\n        this.promiseList = [];\n        this.processedFileNumber = 0;\n        this.processArgs = [];\n        this.state = {\n            downloadVisible: false,\n            viewType: 'normal',\n        };\n        this.beforeUpload = (file, fileList) => {\n            const { beforeUpload } = this.props;\n            this.uploadFileListLength = fileList.length;\n            if (beforeUpload) {\n                return beforeUpload(file, fileList);\n            }\n            return true;\n        };\n        this.handleUpload = (option) => {\n            this.processArgs.push(option);\n            if (this.processArgs.length === this.uploadFileListLength) {\n                this.startUpload();\n            }\n        };\n        this.startUpload = () => __awaiter(this, void 0, void 0, function* () {\n            const { maxUploadNum, fileType, entityId } = this.props;\n            if (maxUploadNum) {\n                for (const option of this.processArgs) {\n                    const { file } = option;\n                    const fileSize = file.size && file.size > 1024 ? Math.round(file.size / 1024) : 1;\n                    const { name = '' } = file;\n                    const data = new FormData();\n                    data.append('request', file);\n                    data.append('fileName', name);\n                    if (fileType)\n                        data.append('type', fileType);\n                    if (entityId)\n                        data.append('entityId', `${entityId}`);\n                    data.append('fileSize', `${fileSize}`);\n                    this.promiseList.push(this.processRequest(data, option));\n                    this.processedFileNumber += 1;\n                    if (this.processedFileNumber === this.uploadFileListLength) {\n                        const responses = yield Promise.all(this.promiseList);\n                        responses.forEach(res => {\n                            const { response, option: rcOption } = res;\n                            thenProcess(rcOption, response);\n                        });\n                        this.promiseList = [];\n                        this.processedFileNumber = 0;\n                        this.processArgs = [];\n                        return;\n                    }\n                    if (this.promiseList.length === maxUploadNum) {\n                        const responses = yield Promise.all(this.promiseList);\n                        responses.forEach(res => {\n                            const { response, option: rcOption } = res;\n                            thenProcess(rcOption, response);\n                        });\n                        this.promiseList = [];\n                    }\n                }\n                return;\n            }\n            this.processArgs.forEach(option => {\n                const { file, onError } = option;\n                const fileSize = file.size && file.size > 1024 ? Math.round(file.size / 1024) : 1;\n                const { name = '' } = file;\n                const data = new FormData();\n                data.append('request', file);\n                data.append('fileName', name);\n                if (fileType)\n                    data.append('type', fileType);\n                if (entityId)\n                    data.append('entityId', `${entityId}`);\n                data.append('fileSize', `${fileSize}`);\n                this.processRequest(data, option)\n                    .then(res => {\n                    const { response, option: rcOption } = res;\n                    thenProcess(rcOption, response);\n                })\n                    .catch(error => {\n                    onError(error);\n                });\n            });\n            this.processArgs = [];\n        });\n        this.processRequest = (data, option) => {\n            const { uploadUrl } = this.props;\n            const { onProgress } = option;\n            return new Promise(resolve => {\n                request({\n                    url: uploadUrl,\n                    method: 'post',\n                    data,\n                    onUploadProgress: ({ loaded, total }) => {\n                        const percent = Number(Math.round((loaded / total) * 100).toFixed(2));\n                        onProgress({ percent }, option.file);\n                    },\n                    headers: {\n                        neverCancel: true,\n                    },\n                })\n                    .then((res) => {\n                    resolve({\n                        option,\n                        response: res,\n                    });\n                })\n                    .catch((error) => resolve({ response: error, option }));\n            });\n        };\n        this.onChange = (info) => {\n            const { fileList, file } = info;\n            const { onChange, getThumbUrl } = this.props;\n            // 获取缩略图地址\n            if (file.status === 'done' && getThumbUrl && isPhoto(file.name)) {\n                const url = getThumbUrl(file);\n                fileList.forEach((item, index) => {\n                    if (item.uid === file.uid) {\n                        fileList.splice(index, 1, Object.assign(Object.assign(Object.assign({}, item), file), { thumbUrl: url }));\n                    }\n                });\n            }\n            // 过滤掉beforeUpload返回false时的文件list\n            const filterList = fileList.filter(list => list.status);\n            this.setState({ fileList: filterList }, () => {\n                if (onChange) {\n                    onChange(info);\n                }\n            });\n        };\n        this.handlerViewType = (viewType) => {\n            this.setState({ viewType });\n        };\n        this.onChangeDownloadVisible = () => {\n            const { downloadVisible } = this.state;\n            this.setState({ downloadVisible: !downloadVisible });\n        };\n        this.deleteFile = (file) => {\n            if (this.upload) {\n                this.upload.handleRemove(file);\n            }\n        };\n        this.downloadFile = (file) => {\n            const { downloadFile } = this.props;\n            if (downloadFile) {\n                if (Array.isArray(file)) {\n                    const config = downloadFile(file);\n                    return request(config);\n                }\n                const config = downloadFile(file);\n                request(config)\n                    .then(res => {\n                    blobToFile(res);\n                })\n                    .catch(error => {\n                    console.error(error);\n                });\n            }\n        };\n        this.renderComponent = (locale) => {\n            const _a = this.props, { downloadable, className, style, showUploadList, onPreview, onShare, showByFileType, typeList, getFileType } = _a, rest = __rest(_a, [\"downloadable\", \"className\", \"style\", \"showUploadList\", \"onPreview\", \"onShare\", \"showByFileType\", \"typeList\", \"getFileType\"]);\n            const { fileList = [], viewType, downloadVisible } = this.state;\n            const uploadProps = Object.assign({}, rest);\n            return (<div className={cls(className, 'seid-upload')} style={style}>\n        <ToolBar rowClassName=\"tool-bar\" left={[\n                <Upload ref={ref => {\n                    this.upload = ref;\n                }} key=\"upload\" {...uploadProps} beforeUpload={this.beforeUpload} customRequest={(options) => __awaiter(this, void 0, void 0, function* () { return this.handleUpload(options); })} onChange={this.onChange} fileList={fileList} showUploadList={false}>\n              <Button type=\"primary\" icon=\"upload\">\n                {get(locale, 'upload')}\n              </Button>\n            </Upload>,\n                downloadable ? (<Button className=\"download-btn\" onClick={this.onChangeDownloadVisible} key=\"download\" icon=\"download\">\n                {get(locale, 'batchDownload')}\n              </Button>) : null,\n            ]} right={<div className=\"tool-box\">\n              <span className={cls('tool-btn', { select: viewType === 'normal' })} onClick={() => this.handlerViewType('normal')}>\n                <Tooltip title={get(locale, 'normal')}>\n                  <Icon type=\"bars\" style={{ fontSize: '18px' }}/>\n                </Tooltip>\n              </span>\n              <span className={cls('tool-btn', { select: viewType === 'simple' })} onClick={() => this.handlerViewType('simple')}>\n                <Tooltip title={get(locale, 'simple')}>\n                  <Icon type=\"appstore\" style={{ fontSize: '18px' }}/>\n                </Tooltip>\n              </span>\n            </div>}/>\n        {showUploadList ? (<FileListComponent showByFileType={showByFileType} typeList={typeList} getFileType={getFileType} downloadFile={this.downloadFile} deleteFile={this.deleteFile} onPreview={onPreview} onShare={onShare} mode={viewType} fileList={fileList}/>) : null}\n        {downloadVisible ? (<DownloadModal visible={downloadVisible} onClose={this.onChangeDownloadVisible} locale={locale} fileList={fileList} downloadFiles={this.downloadFile}/>) : null}\n      </div>);\n        };\n    }\n    render() {\n        return (<SeidLocaleReceiver defaultLocale={defaultLocale} componentName=\"Attachment\">\n        {this.renderComponent}\n      </SeidLocaleReceiver>);\n    }\n}\nAttachment.defaultProps = {\n    showUploadList: true,\n    showByFileType: false,\n    getFileType: (file) => ({\n        code: get(file, 'response[0].documentTypeEnum'),\n        name: get(file, 'response[0].documentTypeEnumRemark'),\n    }),\n};\nAttachment.getDerivedStateFromProps = (nextProps, prevState) => {\n    const { fileList } = prevState;\n    if ('fileList' in nextProps &&\n        nextProps.fileList &&\n        (!fileList || fileList.length !== nextProps.fileList.length)) {\n        return {\n            fileList: nextProps.fileList,\n        };\n    }\n    if ('defaultFileList' in nextProps && !fileList) {\n        return {\n            fileList: nextProps.defaultFileList,\n        };\n    }\n    return null;\n};\nexport default Attachment;\n"],"file":"index.js"}