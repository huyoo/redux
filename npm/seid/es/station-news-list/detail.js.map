{"version":3,"sources":["station-news-list/detail.jsx"],"names":["React","PureComponent","Descriptions","Modal","Spin","Icon","handleMessageType","BraftEditors","request","StationNewsListDetail","props","handleCancel","onCancel","handleGetDetail","getNewsDetailUrl","params","getNewsDetailUrlRequestMethod","setState","loading","promise","method","url","then","res","data","error","console","getMessageAttachment","JSON","parse","e","info","title","content","onOk","destroyAll","state","propsData","Object","keys","length","visible","footer","modalProps","detailContent","locale","messageAttachment","messageTitle","messageType","messageContent","undefined","publisherNick","publishDate"],"mappings":"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","sourcesContent":["import React, { PureComponent } from 'react';\nimport Descriptions from 'antd/es/descriptions';\nimport Modal from 'antd/es/modal';\nimport Spin from 'antd/es/spin';\nimport Icon from 'antd/es/icon';\nimport { handleMessageType } from './index';\nimport BraftEditors from '../rich-editor';\nimport { request } from '../utils';\nclass StationNewsListDetail extends PureComponent {\n    constructor(props) {\n        super(props);\n        // 关闭modal\n        this.handleCancel = () => {\n            const { onCancel } = this.props;\n            if (onCancel)\n                onCancel();\n        };\n        // 获取消息详情\n        this.handleGetDetail = () => {\n            const { getNewsDetailUrl, params, getNewsDetailUrlRequestMethod } = this.props;\n            this.setState({\n                loading: true,\n            });\n            const promise = request({\n                method: getNewsDetailUrlRequestMethod,\n                url: getNewsDetailUrl,\n                params,\n            });\n            promise\n                .then((res) => {\n                const { data = {} } = res;\n                this.setState({\n                    data,\n                    loading: false,\n                });\n            })\n                .catch((error) => {\n                this.setState({\n                    loading: true,\n                });\n                console.error('error', error);\n            });\n        };\n        this.getMessageAttachment = (data) => {\n            try {\n                if (data)\n                    return JSON.parse(data);\n            }\n            catch (e) {\n                Modal.info({\n                    title: '提醒',\n                    content: <div>上传的附件格式不符合要求</div>,\n                    onOk: () => {\n                        Modal.destroyAll();\n                    },\n                });\n            }\n        };\n        this.state = {\n            data: {},\n            loading: false,\n        };\n    }\n    componentDidMount() {\n        // 如果已有消息体的数据，则不用再通过接口去获取消息数据\n        const { propsData } = this.props;\n        if (propsData && Object.keys(propsData).length) {\n            this.setState({ data: propsData });\n            return;\n        }\n        this.handleGetDetail();\n    }\n    render() {\n        const { visible, footer = null, modalProps, detailContent, locale } = this.props;\n        const { data, loading } = this.state;\n        const messageAttachment = this.getMessageAttachment(data.messageAttachment);\n        return (<Modal title=\"消息详情\" visible={visible} onCancel={this.handleCancel} footer={footer} centered destroyOnClose {...modalProps}>\n        <Spin spinning={loading}>\n          {detailContent || (<div className=\"detailWrapper\">\n              <Descriptions column={2}>\n                <Descriptions.Item span={2} label=\"消息标题\">\n                  {data.messageTitle}\n                </Descriptions.Item>\n                <Descriptions.Item span={2} label=\"消息类型\">\n                  {handleMessageType(data.messageType, locale)}\n                </Descriptions.Item>\n                <Descriptions.Item className=\"braft-wrapper\" span={2} label=\"消息内容\">\n                  {data.messageContent !== undefined && (<BraftEditors.View content={data.messageContent}/>)}\n                </Descriptions.Item>\n                <Descriptions.Item span={2} label=\"发送人\">\n                  {data.publisherNick}\n                </Descriptions.Item>\n                <Descriptions.Item span={2} label=\"发送时间\">\n                  {data.publishDate}\n                </Descriptions.Item>\n                {data.messageAttachment && (<Descriptions.Item span={2} label=\"消息附件\">\n                    <a href={messageAttachment ? messageAttachment[0].url : undefined} target=\"_blank\" rel=\"noopener noreferrer\">\n                      <Icon type=\"link\" className=\"iconMR\"/>\n                      附件\n                    </a>\n                  </Descriptions.Item>)}\n              </Descriptions>\n            </div>)}\n        </Spin>\n      </Modal>);\n    }\n}\nexport default StationNewsListDetail;\n"],"file":"detail.js"}