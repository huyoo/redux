{"version":3,"sources":["station-news-card/index.jsx"],"names":["React","PureComponent","Card","Divider","Icon","get","Detail","request","SeidLocaleReceiver","defaultLocale","StationNewsCard","props","handleGet","getNewsListUrl","getNewsListParams","showNum","setState","loading","url","params","then","res","data","list","slice","error","console","onClick","event","messageId","preventDefault","handleClickItem","visible","handleCancel","toMoreStations","handletoMoreStations","renderCom","locale","extraTxt","avatar","listTitle","contentRight","description","getNewsDetailUrl","getNewsDetailUrlRequestMethod","cardProps","modalProps","detailContent","state","propsToDetail","onCancel","userId","width","map","item","index","e","__html","length","nextProps","reload","defaultProps","listIconStyle","fontSize","marginTop"],"mappings":"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","sourcesContent":["import React, { PureComponent } from 'react';\nimport Card from 'antd/es/card';\nimport Divider from 'antd/es/divider';\nimport Icon from 'antd/es/icon';\nimport get from 'lodash/get';\nimport Detail from '../station-news-list/detail';\nimport { request } from '../utils';\nimport SeidLocaleReceiver from '../seid-locale-receiver';\nimport defaultLocale from './locale';\nclass StationNewsCard extends PureComponent {\n    constructor(props) {\n        super(props);\n        // 获取未处理的站内消息\n        this.handleGet = () => {\n            const { getNewsListUrl, getNewsListParams, showNum } = this.props;\n            this.setState({\n                loading: true,\n            });\n            request({ url: getNewsListUrl, params: Object.assign({}, getNewsListParams) })\n                .then(res => {\n                const { data = {} } = res;\n                this.setState({\n                    loading: false,\n                    data: data.list.slice(0, showNum),\n                });\n            })\n                .catch(error => {\n                this.setState({\n                    loading: true,\n                });\n                console.error('error', error);\n            });\n        };\n        // 查看详情\n        this.onClick = (event, messageId) => {\n            event.preventDefault();\n            const { handleClickItem } = this.props;\n            if (handleClickItem) {\n                handleClickItem(messageId);\n            }\n            this.setState({\n                visible: true,\n                messageId,\n            });\n        };\n        this.handleCancel = () => {\n            this.setState({ visible: false });\n        };\n        // 点击'更多'\n        this.toMoreStations = () => {\n            const { handletoMoreStations } = this.props;\n            if (handletoMoreStations)\n                handletoMoreStations();\n        };\n        this.renderCom = (locale) => {\n            const { extraTxt = get(locale, 'more'), avatar, listTitle, contentRight, description, getNewsDetailUrl, getNewsDetailUrlRequestMethod, getNewsListParams, cardProps, modalProps, detailContent, } = this.props;\n            const { data, visible, messageId, loading } = this.state;\n            const propsToDetail = {\n                getNewsDetailUrl,\n                getNewsDetailUrlRequestMethod,\n                visible,\n                onCancel: this.handleCancel,\n                params: {\n                    userId: getNewsListParams.userId,\n                    messageId,\n                },\n                modalProps,\n                detailContent,\n            };\n            return (<>\n        <Card title={get(locale, 'message')} extra={<a onClick={this.toMoreStations}>{extraTxt}</a>} style={{ width: 300 }} {...cardProps} loading={loading}>\n          {data.map((item, index) => (<div className=\"station-news--card-Wrapper\" key={item.messageId} onClick={e => this.onClick(e, item.messageId)}>\n              <li>\n                <div className=\"station-news--card-top\">\n                  <div>{avatar}</div>\n                  <div className=\"station-news--card-right\">\n                    <h4 className=\"station-news--card-title\">{listTitle ? item[listTitle] : ''}</h4>\n                    {description ? (<p className=\"station-news--card-content\" dangerouslySetInnerHTML={{ __html: item[description] }}/>) : ('')}\n                  </div>\n                </div>\n                <div className=\"station-news--card-bottom\">\n                  <p>{contentRight ? item[contentRight] : ''}</p>\n                </div>\n              </li>\n              {data.length === index + 1 ? null : <Divider />}\n            </div>))}\n        </Card>\n        {visible ? <Detail locale={locale} {...propsToDetail}/> : null}\n      </>);\n        };\n        this.state = {\n            data: [],\n            loading: false,\n            visible: false,\n            messageId: '',\n        };\n    }\n    componentDidMount() {\n        this.handleGet();\n    }\n    componentWillReceiveProps(nextProps) {\n        if (nextProps.reload !== this.props.reload) {\n            this.handleGet();\n        }\n    }\n    render() {\n        return (<SeidLocaleReceiver defaultLocale={defaultLocale} componentName=\"StationNewsCard\">\n        {this.renderCom}\n      </SeidLocaleReceiver>);\n    }\n}\nStationNewsCard.defaultProps = {\n    listIconStyle: {},\n    avatar: <Icon type=\"mail\" style={{ fontSize: 16, marginTop: 4 }}/>,\n    listTitle: 'messageTitle',\n    description: 'messageContent',\n    contentRight: 'publishDate',\n    getNewsDetailUrlRequestMethod: 'get',\n    showNum: 3,\n};\nexport default StationNewsCard;\n"],"file":"index.js"}